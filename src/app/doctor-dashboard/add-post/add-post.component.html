<div class="add-post-container">
    <h2><i class="fas fa-plus-circle"></i> Add New Post</h2>
    <form [formGroup]="addPostForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="category"><i class="fas fa-tags"></i> Category</label>
        <select id="category" formControlName="category" class="form-control">
          <option value="human">Human Blog</option>
          <option value="vet">Veterinary Blog</option>
        </select>
      </div>
  
      <div formArrayName="sections">
        <div *ngFor="let section of sections.controls; let i=index" [formGroupName]="i" class="section">
          <div class="section-header">
            <h3><i class="fas fa-layer-group"></i> Section {{ i + 1 }}</h3>
            <button *ngIf="sections.length > 1" type="button" class="remove-section" (click)="removeSection(i)">
              <i class="fas fa-trash"></i> Remove
            </button>
          </div>
  
          <div class="form-group">
            <label for="title-{{i}}"><i class="fas fa-heading"></i> Title</label>
            <input
              id="title-{{i}}"
              formControlName="title"
              type="text"
              placeholder="Enter section title"
              [class.invalid]="titleControls[i]?.invalid && (titleControls[i]?.touched || titleControls[i]?.dirty)"
            >
            <div class="error" *ngIf="titleControls[i]?.invalid && (titleControls[i]?.touched || titleControls[i]?.dirty)">
              <span *ngIf="titleControls[i]?.errors?.['required']">Title is required.</span>
              <span *ngIf="titleControls[i]?.errors?.['minlength']">Title must be at least 5 characters.</span>
            </div>
          </div>
  
          <div class="form-group">
            <label for="content-{{i}}"><i class="fas fa-paragraph"></i> Content</label>
            <textarea
              id="content-{{i}}"
              formControlName="content"
              placeholder="Enter section content"
              [class.invalid]="contentControls[i]?.invalid && (contentControls[i]?.touched || contentControls[i]?.dirty)"
            ></textarea>
            <div class="error" *ngIf="contentControls[i]?.invalid && (contentControls[i]?.touched || contentControls[i]?.dirty)">
              <span *ngIf="contentControls[i]?.errors?.['required']">Content is required.</span>
              <span *ngIf="contentControls[i]?.errors?.['minlength']">Content must be at least 10 characters.</span>
            </div>
          </div>
  
          <div class="form-group">
            <label for="image-{{i}}"><i class="fas fa-image"></i> Image</label>
            <input
              id="image-{{i}}"
              type="file"
              accept="image/*"
              (change)="onFileChange($event, i)"
              [class.invalid]="imageControls[i]?.invalid && (imageControls[i]?.touched || imageControls[i]?.dirty)"
            >
            <div class="error" *ngIf="imageControls[i]?.invalid && (imageControls[i]?.touched || imageControls[i]?.dirty)">
              <span *ngIf="imageControls[i]?.errors?.['required']">Image is required.</span>
            </div>
          </div>
  
          <button type="button" class="add-section" (click)="addSection()">
            <i class="fas fa-plus"></i> Add Section
          </button>
        </div>
      </div>
  
      <div class="form-actions">
        <button type="submit" [disabled]="isSubmitting">
          <i class="fas fa-check"></i> {{ isSubmitting ? 'Submitting...' : 'Add Post' }}
        </button>
        <button type="button" (click)="cancel()">
          <i class="fas fa-times"></i> Cancel
        </button>
      </div>
  
      <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>
    </form>
  </div>